# Kimai Aggregator

Веб-приложение и десктопное приложение (Electron) для агрегации и анализа данных из Kimai - системы учета рабочего времени.

## Возможности

- Подключение к Kimai API через URL и API ключ
- **Динамическая загрузка проектов** из Kimai - система автоматически подхватывает все ваши проекты
- Настройка ставки оплаты за минуту работы
- **Гибкая настройка параметров для каждого проекта**:
  - Включение/выключение отслеживания
  - Цель по часам в неделю (опционально)
  - Периоды оплаты с итеративным расчетом от начальной недели
  - Этапы проекта с датами начала и окончания
- Агрегация данных по неделям
- Раздельные страницы для разных типов данных:
  - Дашборд с прогрессом текущей недели
  - Таблица времени с детализацией
  - Финансовые отчеты
- **Экспорт и импорт настроек** - сохраните свои настройки проектов в JSON файл
- **Синхронизация настроек по URL** - синхронизируйте настройки между устройствами
- **Темная тема** по умолчанию
- **Electron приложение** - используйте как полноценное десктопное приложение

## Установка

```bash
npm install
```

## Запуск

### Веб-версия (разработка)
```bash
npm run dev
```

### Electron (разработка)
```bash
npm run electron:dev
```

### Сборка Electron приложения
```bash
npm run electron:build
```

## Настройка

1. Откройте приложение
2. Перейдите в раздел "Настройки"
3. Заполните:
   - URL вашего Kimai сервера
   - API ключ (можно получить в профиле пользователя Kimai)
   - Ставку за минуту работы
4. Если возникают ошибки CORS в режиме разработки:
   - Создайте файл `.env` в корне проекта
   - Добавьте строку: `VITE_KIMAI_URL=https://ваш-kimai-сервер.com`
   - Включите опцию "Использовать прокси для обхода CORS" в настройках
   - Перезапустите dev-сервер (`npm run dev`)
5. После сохранения API настроек система автоматически загрузит список ваших проектов из Kimai
6. Для каждого проекта настройте параметры:
   - Включить/выключить отслеживание
   - Настроить цель по часам (если нужно)
   - Настроить периоды оплаты (если нужно) - укажите номер недели и год начала первого периода
   - Настроить этапы проекта (если нужно) - добавьте этапы с датами и плановыми часами

Настройки сохраняются в localStorage браузера (или в Electron - в пользовательской директории).

### Экспорт и импорт настроек

Вы можете экспортировать все настройки (включая параметры проектов) в JSON файл и импортировать их обратно. Это полезно для:
- Резервного копирования настроек
- Переноса настроек между устройствами
- Сохранения конфигурации при переустановке

### Синхронизация по URL

Вы можете настроить URL для синхронизации настроек. Это позволяет синхронизировать настройки между несколькими устройствами:
1. Экспортируйте настройки на одном устройстве
2. Загрузите JSON файл на веб-сервер или используйте сервис для обмена файлами
3. Укажите URL этого файла в настройках на других устройствах
4. Нажмите "Импорт из URL" для синхронизации

## Использование

После настройки API используйте боковое меню для навигации:
- **Дашборд** - прогресс текущей недели и общая статистика
- **Таблица времени** - детальная таблица с записями времени по неделям
- **Финансы** - финансовые отчеты по неделям и периодам
- **Настройки** - конфигурация приложения

## Решение проблем с CORS

Если вы видите ошибки CORS при работе с API:

**В режиме разработки:**
1. Создайте файл `.env` в корне проекта
2. Добавьте: `VITE_KIMAI_URL=https://ваш-kimai-сервер.com`
3. Включите опцию "Использовать прокси" в настройках
4. Перезапустите dev-сервер

**В production:**
- Настройте CORS на сервере Kimai, разрешив запросы с вашего домена
- Или используйте Electron версию приложения, которая не имеет ограничений CORS

## Структура проекта

```
├── src/
│   ├── components/     # React компоненты
│   ├── pages/         # Страницы приложения
│   ├── hooks/         # React хуки
│   ├── services/      # API клиент и бизнес-логика
│   └── App.jsx        # Главный компонент
├── electron/          # Electron конфигурация
└── package.json
```

## Лицензия

MIT
